# Template file for 'libbass'
pkgname=libbass
version=2.4.15
revision=1
archs="i686 x86_64 arm* aarch64*"
create_wrksrc=yes
hostmakedepends="unzip"
depends="alsa-lib"
short_desc="BASS audio library"
maintainer="Franc[e]sco <lolisamurai@tfwno.gf>"
license="custom:Proprietary"
homepage="https://www.un4seen.com/"
repository=nonfree
restricted=yes
nostrip=yes

case "$XBPS_TARGET_MACHINE" in
	x86_64|i686)
		checksum="05200f84de1ba507e717f607640ccc3b5cef5860c002b61130b17941418d01fc"
		distfiles="http://dl.un4seen.com/files/bass24-linux.zip>${pkgname}-${version}.zip"
	;;
	arm*|aarch64*)
		checksum="701a60df1651c002e2b2bd7f00a53be4e5c894b550300b9b7fab710d2ea9784b"
		distfiles="http://www.un4seen.com/stuff/bass24-linux-arm.zip>${pkgname}-${version}.zip"
	;;
esac

post_extract() {
	grep Lic -A62 bass.txt > LICENSE
}

do_install() {
	vinstall bass.h 644 /usr/include/
	vdoc bass.chm
	case "$XBPS_TARGET_MACHINE" in
		i686) _libfile=libbass.so ;;
		x86_64) _libfile=x64/libbass.so ;;
		arm*) _libfile=arm/hardfp/libbass.so ;;
		aarch64*) _libfile=arm/aarch64/libbass.so ;;
	esac
	vinstall ${_libfile} 755 /usr/lib/ libbass.so.${version}
	ln -s libbass.so.${version} "${DESTDIR}/usr/lib/libbass.so"
	vlicense LICENSE
}

libbass-devel_package() {
	short_desc+=" - development files"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
	}
}
